{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information",
      "Takt.Infrastructure.Security": "Debug",
      "Takt.Infrastructure.Extensions": "Debug"
    }
  },
  "AllowedHosts": "*",
  "Server": {
    "UseHttps": true,
    "HttpPort": 50080,
    "HttpsPort": 50081,
    "EnableSwagger": true,
    "EnableCors": true
  },
  "Cors": {
    "EnableAll": true,
    "PolicyName": "TaktPolicy",
    "Origins": [
      "http://localhost:60080",
      "https://localhost:60081",
      "http://localhost:50080",
      "https://localhost:50081"
    ],
    "Methods": [
      "GET",
      "POST",
      "PUT",
      "DELETE",
      "OPTIONS"
    ],
    "Headers": [
      "*"
    ],
    "AllowCredentials": true
  },
  "Cache": {
    "Provider": "Memory",
    "DefaultExpirationMinutes": 30,
    "EnableSlidingExpiration": true,
    "EnableMultiLevelCache": false,
    "Memory": {
      "CompactionThreshold": 1048576,
      "ExpirationScanFrequency": 60,
      "SizeLimit": 104857600
    },
    "Redis": {
      "Enabled": false,
      "ConnectionString": "",
      "InstanceName": "Takt.Xp",
      "DefaultDatabase": 0,
      "ConnectTimeout": 5000,
      "SyncTimeout": 5000,
      "AllowAdmin": true,
      "Ssl": false,
      "Password": "",
      "EnableCompression": true,
      "CompressionThreshold": 1024
    }
  },
  "ConnectionStrings": {
    "IdentityDB": "Server=fs03;Database=Takt_Dev_Entra;User Id=sa;Password=Tac26901333.;MultipleActiveResultSets=true;TrustServerCertificate=true",
    "BusinessDB": "Server=fs03;Database=Takt_Dev_Biz;User Id=sa;Password=Tac26901333.;MultipleActiveResultSets=true;TrustServerCertificate=true",
    "WorkflowDB": "Server=fs03;Database=Takt_Dev_Flow;User Id=sa;Password=Tac26901333.;MultipleActiveResultSets=true;TrustServerCertificate=true",
    "GeneratorDB": "Server=fs03;Database=Takt_Dev_LowCode;User Id=sa;Password=Tac26901333.;MultipleActiveResultSets=true;TrustServerCertificate=true"
  },
  "Database": {
    "DbType": 1,
    "IsAutoCloseConnection": true,
    "Multi": true,
    "SqlDiffLog": true,
    "MaxPoolSize": 100,
    "MinPoolSize": 5,
    "ConnectionTimeout": 30,
    "CommandTimeout": 30,
    "SnowflakeId": {
      "enable": true,
      "WorkId": 1
    },
    "Init": {
      "InitDatabase": false,
      "InitSeedData": false
    }
  },
  "Comment": {
    "_comment": "评论配置",
    "MaxCommentLength": 1000,
    "MinCommentLength": 1,
    "EnableSensitiveWordFilter": true,
    "EnableLengthLimit": true,
    "EnableCommentAudit": true,
    "DefaultAuditStatus": 0,
    "AllowAnonymousComment": false,
    "CommentRateLimit": 30,
    "EnableIpLimit": true,
    "DailyIpCommentLimit": 50,
    "EnableUserCommentLimit": true,
    "DailyUserCommentLimit": 20,
    "EnableDuplicateCheck": true,
    "DuplicateCheckHours": 24
  },
  "Excel": {
    "Author": "Takt365",
    "Title": "极限节拍",
    "Subject": "导入导出文档",
    "Category": "业务数据",
    "Keywords": "Takt.Xp,Excel,Export",
    "Comments": "由极限节拍系统导出",
    "Status": "已完成",
    "Application": "Takt.Xp",
    "Company": "Takt365",
    "Manager": "Takt365"
  },
  "Security": {
    "CsrfTokenExpirationMinutes": 30,
    "LoginPolicy": {
      "MaxFailedAttempts": 5,
      "LockoutMinutes": 30,
      "EnableLoginRestriction": true,
      "CaptchaRequiredAttempts": 3,
      "CaptchaRequiredMinutes": 5,
      "RepeatLoginMinutes": 5
    },
    "Registration": {
      "Enabled": false,
      "RequireEmailVerification": true,
      "RequirePhoneVerification": false,
      "AllowAnonymousRegistration": false,
      "RequireAdminApproval": true,
      "DefaultRole": "User",
      "DefaultStatus": 0,
      "VerificationCodeExpirationMinutes": 10,
      "RegistrationRateLimit": 5,
      "IpRegistrationRateLimit": 10
    },
    "PasswordPolicy": {
      "MinLength": 6,
      "MaxLength": 20,
      "RequireDigit": true,
      "RequireLowercase": true,
      "RequireUppercase": false,
      "RequireSpecialChar": false,
      "PasswordExpirationDays": 90,
      "DefaultPassword": "123456",
      "DefaultErrorLimit": 3,
      "DefaultLockTime": 30
    },
    "Session": {
      "SingleUserLoginEnabled": true,
      "EnableDeviceFingerprint": true,
      "EnableIpValidation": false,
      "EnableLocationValidation": false,
      "HeartbeatIntervalSeconds": 30,
      "OfflineDetectionDelaySeconds": 60,
      "TimeoutMinutes": 30,
      "EnableSlidingExpiration": true,
      "EnableAbsoluteExpiration": true,
      "AbsoluteExpirationHours": 24,
      "SessionExpiryMinutes": 60
    }
  },
  "Jwt": {
    "SecretKey": "vCVQF1fJIz1yt41bQx2kOqWWiHoT03QgLX2HTogAxR7zGqDNbpeMGT",
    "Issuer": "Takt.Xp",
    "Audience": "Takt.WebApi",
    "ExpirationMinutes": 120,
    "RefreshTokenExpirationDays": 7
  },
  "LogCleanup": {
    "Enabled": true,
    "Interval": 24,
    "AuditLogRetentionDays": 90,
    "OperLogRetentionDays": 90,
    "LoginLogRetentionDays": 90,
    "ExceptionLogRetentionDays": 90,
    "DbDiffLogRetentionDays": 90,
    "BatchSize": 1000
  },
  "LogArchive": {
    "Enabled": true,
    "ArchivePeriodMonths": 1,
    "ArchivePath": "Logs/Archive",
    "FileNameFormat": "logs_{0:yyyy_MM}.zip",
    "BatchSize": 1000,
    "CronExpression": "0 0 1 1 * ?"
  },
  "Captcha": {
    "Enabled": false,
    "Type": "Behavior",
    "Slider": {
      "Width": 400,
      "Height": 100,
      "SliderWidth": 48,
      "Tolerance": 8,
      "ExpirationMinutes": 5,
      "BackgroundImages": {
        "RedownloadOnStartup": false,
        "MinCount": 5,
        "DownloadUrl": "https://picsum.photos/{width}/{height}",
        "StoragePath": "slide/background",
        "FileExtension": ".jpg",
        "Template": {
          "UseTemplate": true,
          "TemplatePath": "slide/template",
          "GroupCount": 5
        }
      }
    },
    "Behavior": {
      "ScoreThreshold": 0.5,
      "DataExpirationMinutes": 30,
      "EnableMachineLearning": false
    }
  },
  "Monitoring": {
    "Enabled": true,
    "RefreshInterval": 5,
    "ProcessFilter": {
      "ExcludeSystemProcesses": true,
      "MinMemoryUsageMB": 50,
      "MaxProcessCount": 50
    },
    "NetworkFilter": {
      "ExcludeLoopback": true,
      "ExcludeDisabled": true
    },
    "ServiceFilter": {
      "ExcludeDisabled": true,
      "ExcludeSystemServices": false
    },
    "Alerts": {
      "CpuThreshold": 90,
      "MemoryThreshold": 90,
      "DiskThreshold": 90
    }
  },
  "TaktMail": {
    "Host": "smtp.qq.com",
    "Port": 587,
    "UseSsl": true,
    "FromEmail": "your-email@qq.com",
    "FromName": "Takt.Xp系统通知",
    "UserName": "your-email@qq.com",
    "Password": "your-password"
  },
  "TaktQuartz": {
    "Enabled": true,
    "InstanceName": "TaktQuartzScheduler",
    "TablePrefix": "QRTZ_",
    "SerializerType": "json",
    "UseDatabase": true,
    "Cluster": {
      "Enabled": false,
      "CheckinInterval": 15000,
      "CheckinMisfireThreshold": 15000
    },
    "ThreadPool": {
      "MaxConcurrency": 10,
      "ThreadPriority": 5
    }
  },
  "SystemRestart": {
    "ClearUserSessions": true,
    "ClearCache": true,
    "ClearRealTimeConnections": true,
    "ClearSystemStatus": true,
    "ClearSecurityInfo": true,
    "ClearTempData": true,
    "ClearPerformanceData": true,
    "ClearDistributedState": true,
    "ClearTokenBlacklist": false
  },
  "SignalR": {
    "EnableDetailedErrors": true,
    "ClientTimeoutInterval": 60,
    "KeepAliveInterval": 30,
    "HandshakeTimeout": 15,
    "MaximumReceiveMessageSize": 32768,
    "StreamBufferCapacity": 10,
    "EnableMessagePack": true,
    "Transport": {
      "WebSockets": {
        "CloseTimeout": 5,
        "SubProtocol": "json"
      },
      "ServerSentEvents": {
        "ClientTimeoutInterval": 60
      },
      "LongPolling": {
        "PollTimeout": 90
      }
    },
    "Authentication": {
      "RequireAuthentication": true,
      "TokenValidation": {
        "ValidateIssuer": true,
        "ValidateAudience": true,
        "ValidateLifetime": true,
        "ValidateIssuerSigningKey": true
      }
    },
    "DeviceManagement": {
      "EnableDeviceTracking": true,
      "DeviceTimeoutMinutes": 30
    }
  },
  "SignalRCache": {
    "DefaultCacheMinutes": 30,
    "MaxUsers": 10000,
    "MaxCacheSizeMB": 100,
    "CleanupIntervalMinutes": 5,
    "EnableSizeLimit": true,
    "EnableUserLimit": true,
    "EnableConnectionLimit": true,
    "EnableAutoCleanup": true
  },
  "Workflow": {
    "MaxExecutionDays": 3,
    "AutoExecution": {
      "Enabled": true,
      "IntervalMinutes": 2
    },
    "TimeoutReminder": {
      "Enabled": true,
      "IntervalMinutes": 5,
      "ReminderHours": 24
    },
    "Cleanup": {
      "Enabled": true,
      "RetentionDays": 90,
      "CronExpression": "0 0 2 * * ?"
    }
  },
  "FileUpload": {
    "Import": {
      "MultipartBodyLengthLimit": 10485760,
      "MultipartHeadersLengthLimit": 32768,
      "MultipartBoundaryLengthLimit": 128,
      "ValueLengthLimit": 10485760,
      "KeyLengthLimit": 1024,
      "MaxFileSize": 10485760,
      "AllowedExtensions": [
        ".xlsx",
        ".txt"
      ]
    },
    "Normal": {
      "MultipartBodyLengthLimit": 20971520,
      "MultipartHeadersLengthLimit": 32768,
      "MultipartBoundaryLengthLimit": 128,
      "ValueLengthLimit": 20971520,
      "KeyLengthLimit": 1024,
      "MaxFileSize": 20971520,
      "AllowedExtensions": [
        ".jpg",
        ".jpeg",
        ".png",
        ".gif",
        ".pdf",
        ".docx",
        ".xlsx",
        ".pptx",
        ".txt",
        ".mp4",
        ".avi",
        ".mov",
        ".wmv",
        ".flv",
        ".mkv"
      ]
    },
    "Avatar": {
      "MultipartBodyLengthLimit": 5242880,
      "MultipartHeadersLengthLimit": 32768,
      "MultipartBoundaryLengthLimit": 128,
      "ValueLengthLimit": 5242880,
      "KeyLengthLimit": 1024,
      "MaxFileSize": 5242880,
      "AllowedExtensions": [
        ".jpg",
        ".jpeg",
        ".png",
        ".gif",
        ".bmp",
        ".webp"
      ]
    }
  }
}